{% if snap and snap.units_total > 0 %}
<div class="progress-bar-container">
	<div class="progress-bar">
		<div class="progress-fill" style="width: {{ snap.completion_pct }}%"></div>
	</div>
	<span class="progress-label">{{ '%.0f'|format(snap.completion_pct) }}%</span>
</div>
<div class="unit-counts">
	<span class="count">{{ snap.units_total }} total</span>
	<span class="count pending">{{ snap.units_pending }} pending</span>
	<span class="count running">{{ snap.units_running }} running</span>
	<span class="count completed">{{ snap.units_completed }} done</span>
	<span class="count failed">{{ snap.units_failed }} failed</span>
</div>
{% if units %}
<ul class="unit-list">
	{% for u in units %}
	<li class="unit-item unit-{{ u.status }}">
		<span class="unit-item-title"
			{% if project_name %}
			hx-get="/project/{{ project_name }}/partials/unit/{{ u.id }}"
			hx-target="next .unit-expand"
			hx-swap="innerHTML"
			{% endif %}
			style="cursor:pointer">
			{{ u.title[:60] }}
		</span>
		<span class="badge badge-{{ u.status }}">{{ u.status }}</span>
		{% if u.status == 'failed' and project_name %}
		<button class="btn btn-small btn-retry"
			hx-post="/project/{{ project_name }}/retry/{{ u.id }}"
			hx-target="#toast-container"
			hx-swap="innerHTML">
			Retry
		</button>
		{% endif %}
		<div class="unit-expand"></div>
	</li>
	{% endfor %}
</ul>
{% endif %}
{% else %}
<p class="muted">No work units</p>
{% endif %}
